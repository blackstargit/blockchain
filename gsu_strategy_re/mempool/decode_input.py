from web3 import Web3, HTTPProvider
import json
from eth_utils import to_hex

# Load the ABI from a file
with open('./vault_abi.json', 'r') as f:
    vault_abi = json.load(f)

# Connect to the Ethereum network using Infura
infura_url = 'https://mainnet.infura.io/v3/c2277863d49b42909d1a6b452b4d2553'
web3 = Web3(HTTPProvider(infura_url))

# Balancer Vault contract address
vault_address = '0xBA12222222228d8Ba445958a75a0704d566BF2C8'

# Create a contract instance
vault_contract = web3.eth.contract(address=vault_address, abi=vault_abi)

# # Transaction hash
# tx_hash = '0xade0b328f9b0df8d67122b0c92bdd7b885b5e0d1781978f27322e70f0476e918'

# # Get the transaction details
# tx = web3.eth.get_transaction(tx_hash)

# Extract the input data from the transaction
input_data_1 = "0x8bdb3913b986fd52697f16be888bfad2c5bf12cd67ce834b000200000000000000000634000000000000000000000000d37c6a81539cf1c7083c07a4fddaa52572ded684000000000000000000000000d37c6a81539cf1c7083c07a4fddaa52572ded6840000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000003106a0a076bedae847652f42ef07fd58589e001f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000102ecdb460de6f00000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a23b3910505100000000000000000000000000000000000000000000000000000000000000000001"
input_data_2 = "0x945bcec90000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000006800000000000000000000000003a00ec4f32a7e09b23a25241edcc585c584329dd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000003a00ec4f32a7e09b23a25241edcc585c584329dd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000740000000000000000000000000000000000000000000000000001fffffffffffff000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000240000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000003c0000000000000000000000000000000000000000000000000000000000000048020facecaa68e9b7c92d2d0ec9136d864df8052330001000000000000000001900000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000022b1c8c1227a000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000003de27efa2f1aa663ae5d458857e731c129069f2900020000000000000000058800000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f01b0684c98cd7ada480bfdf6e43876422fa1fc10002000000000000000005de00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000020facecaa68e9b7c92d2d0ec9136d864df8052330001000000000000000001900000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000022b1c8c1227a000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000b6b9b165c4ac3f5233a0cf413126c72be28b468a00010000000000000000005a00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000003ebf48cd7586d7a4521ce59e53d9a907ebf1480f00020000000000000000002800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000007f39c581f595b53c5cb19bd0b3f8da6c935e2ca00000000000000000000000007fc66500c84a76ad7e9c93437bfc5ac33e2ddae9000000000000000000000000de30da39c46104798bb5aa3fe8b9e0e1f348163f000000000000000000000000ba100000625a3754423978a60c9317c58a424e3d0000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000369021d88f16a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffba9c6e7dbb0c00000000000000000000000000000000000000000000000000000000000000000000"
input_data_3 = "0x945bcec90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000003e000000000000000000000000053ebe4968e3175f1af0821361eae5ff8f40b7a43000000000000000000000000000000000000000000000000000000000000000000000000000000000000000053ebe4968e3175f1af0821361eae5ff8f40b7a4300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000460000000000000000000000000000000000000000000000000001fffffffffffff00000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001e0e0e8ac08de6708603cfd3d23b613d2f80e3b7afb00020000000000000000058a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000d886a1ddd8c39200000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000093d199263632a4ef4bb438f1feb99e57b4b5f0bd0000000000000000000005c200000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000e7e2c68d3b13d905bbb636709cf4dfd21076b9d20000000000000000000005ca00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000028993e5998a4ab700000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000f951e335afb289353dc249e82926178eac7ded780000000000000000000000007f39c581f595b53c5cb19bd0b3f8da6c935e2ca00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000003621a8777630e490000000000000000000000000000000000000000000000000000000000000000fffffffffffffffffffffffffffffffffffffffffffffffffc5f7d61660c27b8"
input_data_4 = "0x52bbbe2900000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000be700a57375eab09fd3fe6be1d060310d5449a6c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000be700a57375eab09fd3fe6be1d060310d5449a6c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003180bd9945aad6a000000000000000000000000000000000000000000000000001fffffffffffffe7e2c68d3b13d905bbb636709cf4dfd21076b9d20000000000000000000005ca0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f951e335afb289353dc249e82926178eac7ded78000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002e289b8f8a7d0a500000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000000"
input_data_5 = "0x52bbbe2900000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000fc0e6a22c50b20dded90ea219c7ae8374a9900e20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fc0e6a22c50b20dded90ea219c7ae8374a9900e200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000157dbaf5793f5113b8000000000000000000000000000000000000000000000000001fffffffffffff41fdbea2e52790c0a1dc374f07b628741f2e062d0002000000000000000006be00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005c5b196abe0d54485975d1ec29617d42d919832600000000000000000000000015700b564ca08d9439c58ca5053166e8317aa1380000000000000000000000000000000000000000000000152c201b6df6efcb6100000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000000"

# Decode the input data
# decoded_input = vault_contract.decode_function_input(input_data_1)
# decoded_input = vault_contract.decode_function_input(input_data_2)
decoded_input = vault_contract.decode_function_input(input_data_3)
# decoded_input = vault_contract.decode_function_input(input_data_4)
# decoded_input = vault_contract.decode_function_input(input_data_5)


# Print the method and parameters
print(decoded_input)
print('Method:', decoded_input[0].signature)
# print('PoolId:', to_hex(decoded_input[1]['singleSwap']['poolId']))
print('PoolId:', to_hex(decoded_input[1]['swaps'][0]['poolId']))
print('Kind:', decoded_input[1]['kind'])